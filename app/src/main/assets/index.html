<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMM Panel Modern</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Hide Scrollbar */
        ::-webkit-scrollbar {
            display: none;
        }
        html, body {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* Mobile menu transition */
        #mobile-menu {
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        #mobile-menu.open {
            max-height: 400px;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans pb-24">

    <!-- Floating Info Popup -->
    <div id="info-popup" class="fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white rounded-2xl shadow-2xl w-11/12 max-w-lg relative transform scale-100 transition-transform duration-300 overflow-hidden animate-fade-in">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white">
                <h2 class="text-2xl font-bold mb-2">ðŸ”¥ Update & Promo Spesial</h2>
                <p class="text-sm opacity-90">Informasi penting untuk member setia kami.</p>
                <button onclick="closePopup()" class="absolute top-4 right-4 bg-white/20 hover:bg-white/30 rounded-full p-2 text-white transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <div class="flex items-start space-x-3">
                    <div class="bg-green-100 p-2 rounded-lg text-green-600">
                        <i class="fas fa-percent"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Diskon Deposit 10%</h3>
                        <p class="text-sm text-gray-600">Berlaku untuk semua metode pembayaran otomatis minimal 50rb.</p>
                    </div>
                </div>
                <div class="flex items-start space-x-3">
                    <div class="bg-blue-100 p-2 rounded-lg text-blue-600">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Layanan Baru Rilis</h3>
                        <p class="text-sm text-gray-600">Tiktok Followers High Quality update terbaru lebih cepat.</p>
                    </div>
                </div>
                <div class="flex items-start space-x-3">
                    <div class="bg-yellow-100 p-2 rounded-lg text-yellow-600">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800">Maintenance API</h3>
                        <p class="text-sm text-gray-600">Layanan Instagram Likes sedang dalam perbaikan server.</p>
                    </div>
                </div>
                <button onclick="closePopup()" class="w-full bg-gray-900 text-white py-3 rounded-xl font-semibold hover:bg-gray-800 transition">Saya Mengerti</button>
            </div>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="fixed w-full z-40 top-0 start-0 glass-effect border-b border-gray-200">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <a href="#" class="flex items-center gap-3">
                <div class="w-10 h-10 bg-gradient-to-tr from-blue-600 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-lg">
                    <i class="fas fa-bolt"></i>
                </div>
                <span class="self-center text-2xl font-bold whitespace-nowrap text-gray-800 tracking-tight">Fayupedia</span>
            </a>
            <button onclick="toggleMenu()" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200">
                <span class="sr-only">Open main menu</span>
                <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
                </svg>
            </button>
            <div class="hidden w-full md:block md:w-auto" id="navbar-default">
                <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:border-0 md:bg-transparent">
                    <li>
                        <a href="#" class="block py-2 px-3 text-white bg-blue-700 rounded md:bg-transparent md:text-blue-700 md:p-0" aria-current="page">Beranda</a>
                    </li>
                    <li>
                        <a href="#order-section" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Pemesanan</a>
                    </li>
                    <li>
                        <a href="#status-section" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Cek Status</a>
                    </li>
                    <li>
                        <a href="#" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Daftar Harga</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Mobile Menu Dropdown -->
        <div id="mobile-menu" class="md:hidden bg-white border-b border-gray-200">
            <ul class="flex flex-col p-4 space-y-2">
                <li><a href="#" class="block py-2 px-4 text-blue-600 bg-blue-50 rounded-lg font-medium">Beranda</a></li>
                <li><a href="#order-section" class="block py-2 px-4 text-gray-700 hover:bg-gray-50 rounded-lg">Pemesanan</a></li>
                <li><a href="#status-section" class="block py-2 px-4 text-gray-700 hover:bg-gray-50 rounded-lg">Cek Status</a></li>
                <li><a href="#" class="block py-2 px-4 text-gray-700 hover:bg-gray-50 rounded-lg">Kontak Admin</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-20 md:pt-24">
        
        <!-- Hero / Slider Section -->
        <div class="w-full md:max-w-6xl md:mx-auto md:px-4 mb-8">
            <div class="relative w-full h-40 md:h-80 md:rounded-2xl overflow-hidden shadow-lg">
                <!-- Slide 1 -->
                <div class="slide absolute inset-0 transition-opacity duration-1000 opacity-100">
                    <img src="https://files.catbox.moe/5po3wn.jpg" alt="Banner 1" class="w-full h-full object-cover">
                </div>
                <!-- Slide 2 -->
                <div class="slide absolute inset-0 transition-opacity duration-1000 opacity-0">
                    <img src="https://files.catbox.moe/5po3wn.jpg" alt="Banner 2" class="w-full h-full object-cover">
                </div>
            </div>
        </div>

        <div class="container mx-auto px-4 pb-12 max-w-6xl">
            
            <!-- OTP / Nokos Banner -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 mb-6 flex items-center justify-between animate-fade-in">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center text-orange-600 text-xl shadow-sm">
                        <i class="fas fa-sim-card"></i>
                    </div>
                    <div class="leading-tight">
                        <h3 class="font-bold text-gray-800">Beli OTP/Nokos?</h3>
                        <p class="text-xs text-gray-500">Verifikasi aplikasi aman & murah.</p>
                    </div>
                </div>
                <a href="https://wa.me/6288976577719?text=Halo%20min,%20saya%20mau%20beli%20OTP/Nokos" target="_blank" class="bg-orange-500 hover:bg-orange-600 text-white px-5 py-2 rounded-full font-bold text-sm shadow-lg shadow-orange-500/30 transition transform active:scale-95">
                    Buy
                </a>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Left Column: Order Form -->
            <div id="order-section" class="lg:col-span-2 space-y-6">
                <div class="bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-blue-600 to-blue-700 p-4 text-white flex justify-between items-center">
                        <h3 class="font-bold text-lg"><i class="fas fa-shopping-cart mr-2"></i> Form Pemesanan Baru</h3>
                        <span class="bg-white/20 px-3 py-1 rounded-full text-xs">Instant</span>
                    </div>
                    <div class="p-5 md:p-8 space-y-6">
                        
                        <!-- Category -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
                            <div class="relative">
                                <select id="category" class="w-full p-3 pl-10 pr-10 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition appearance-none cursor-pointer text-gray-800">
                                    <option value="">-- Pilih Kategori --</option>
                                </select>
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-list"></i>
                                </div>
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-chevron-down text-xs"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Service -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Layanan</label>
                            <div class="relative">
                                <select id="service" class="w-full p-3 pl-10 pr-10 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition appearance-none cursor-pointer text-gray-800" disabled>
                                    <option value="">-- Pilih Layanan --</option>
                                </select>
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-tags"></i>
                                </div>
                                <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-chevron-down text-xs"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Description Box -->
                        <div id="description-box" class="hidden bg-blue-50 p-4 rounded-xl text-sm text-blue-800 border border-blue-100 max-h-96 overflow-y-auto leading-relaxed shadow-inner">
                            <h4 class="font-bold mb-1">Deskripsi Layanan:</h4>
                            <p id="service-description">Pilih layanan untuk melihat deskripsi.</p>
                            <div class="flex flex-wrap gap-2 mt-3 text-xs font-semibold">
                                <span class="bg-white px-2 py-1 rounded border border-blue-200 text-blue-700">Min: <span id="min-order">0</span></span>
                                <span class="bg-white px-2 py-1 rounded border border-blue-200 text-blue-700">Max: <span id="max-order">0</span></span>
                                <span class="bg-white px-2 py-1 rounded border border-blue-200 text-green-600">Harga/1k: Rp <span id="price-per-k">0</span></span>
                            </div>
                        </div>

                        <!-- Target Input -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Target (Link/Username)</label>
                            <div class="relative">
                                <input type="text" id="target" class="w-full p-3 pl-10 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition text-gray-800" placeholder="Contoh: https://instagram.com/username">
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-link"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Quantity -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Jumlah Pesanan</label>
                            <div class="relative">
                                <input type="text" id="quantity" class="w-full p-3 pl-10 pr-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition text-gray-800" placeholder="Masukkan jumlah" oninput="formatQuantity(this)">
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-500">
                                    <i class="fas fa-sort-numeric-up"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Total Price Display -->
                        <div class="flex justify-between items-center bg-gray-900 text-white p-5 rounded-xl shadow-lg gap-4">
                            <div class="flex-1 flex flex-col justify-center overflow-hidden">
                                <p class="text-xs text-gray-400 uppercase tracking-wider mb-0.5">Total Harga</p>
                                <p id="price-display-container" class="text-xl font-bold transition-all duration-200 whitespace-nowrap">Rp <span id="total-price">0</span></p>
                            </div>
                            <button onclick="openConfirmModal()" id="btn-order" class="flex-shrink-0 h-11 bg-blue-600 hover:bg-blue-500 text-white px-8 rounded-lg font-semibold transition shadow-lg shadow-blue-600/50 whitespace-nowrap flex items-center justify-center text-sm md:text-base">
                                Pesan Sekarang
                            </button>
                        </div>

                        <!-- API Status Text -->
                        <div id="api-status-msg" class="text-xs text-center text-gray-400 mt-2"></div>
                    </div>
                </div>

                <!-- FAQ Section -->
                <div class="bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden">
                    <div class="p-4 border-b border-gray-100 bg-gray-50 flex items-center">
                        <i class="fas fa-question-circle mr-2 text-blue-600"></i>
                        <h3 class="font-bold text-gray-800">Pertanyaan Umum (FAQ)</h3>
                    </div>
                    <div class="divide-y divide-gray-100">
                        <!-- FAQ 1 -->
                        <div class="group">
                            <button onclick="toggleFaq(this)" class="w-full text-left p-4 focus:outline-none flex justify-between items-center bg-white hover:bg-gray-50 transition">
                                <span class="font-medium text-sm text-gray-700">Bagaimana cara melakukan deposit?</span>
                                <i class="fas fa-chevron-down text-xs text-gray-400 transition-transform duration-200"></i>
                            </button>
                            <div class="hidden px-4 pb-4 text-sm text-gray-600 bg-white leading-relaxed">
                                Untuk saat ini deposit otomatis belum tersedia. Silakan hubungi admin via WhatsApp untuk melakukan top-up saldo manual atau pembayaran langsung.
                            </div>
                        </div>
                        <!-- FAQ 2 -->
                        <div class="group">
                            <button onclick="toggleFaq(this)" class="w-full text-left p-4 focus:outline-none flex justify-between items-center bg-white hover:bg-gray-50 transition">
                                <span class="font-medium text-sm text-gray-700">Berapa lama pesanan diproses?</span>
                                <i class="fas fa-chevron-down text-xs text-gray-400 transition-transform duration-200"></i>
                            </button>
                            <div class="hidden px-4 pb-4 text-sm text-gray-600 bg-white leading-relaxed">
                                Pesanan biasanya diproses secara instan (otomatis) setelah pembayaran dikonfirmasi. Estimasi masuk bervariasi tergantung layanan, mulai dari 1 menit hingga 24 jam.
                            </div>
                        </div>
                        <!-- FAQ 3 -->
                        <div class="group">
                            <button onclick="toggleFaq(this)" class="w-full text-left p-4 focus:outline-none flex justify-between items-center bg-white hover:bg-gray-50 transition">
                                <span class="font-medium text-sm text-gray-700">Apa itu Partial Status?</span>
                                <i class="fas fa-chevron-down text-xs text-gray-400 transition-transform duration-200"></i>
                            </button>
                            <div class="hidden px-4 pb-4 text-sm text-gray-600 bg-white leading-relaxed">
                                Partial berarti pesanan hanya masuk sebagian dan sisa uang dari jumlah yang belum masuk akan dikembalikan ke saldo akun Anda secara otomatis.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Status Checker & Info -->
            <div class="space-y-6">
                
                <!-- Check Status Widget -->
                <div id="status-section" class="bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-purple-600 to-purple-700 p-4 text-white">
                        <h3 class="font-bold text-lg"><i class="fas fa-search mr-2"></i> Cek Status Pesanan</h3>
                    </div>
                    <div class="p-4 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ID Pesanan</label>
                            <input type="text" id="order-id-check" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none transition" placeholder="Contoh: 123456">
                        </div>
                        <button onclick="checkStatus()" class="w-full bg-purple-600 hover:bg-purple-500 text-white py-3 rounded-xl font-semibold transition shadow-lg shadow-purple-600/30">
                            Cek Status
                        </button>
                        
                        <!-- Status Result Area -->
                        <div id="status-result" class="hidden mt-4 p-4 bg-gray-50 rounded-xl border border-gray-200 text-sm">
                            <p class="flex justify-between mb-1"><span>Status:</span> <span id="res-status" class="font-bold">-</span></p>
                            <p class="flex justify-between mb-1"><span>Awal:</span> <span id="res-start">-</span></p>
                            <p class="flex justify-between"><span>Sisa:</span> <span id="res-remains">-</span></p>
                        </div>
                    </div>
                </div>

                <!-- Account Widget Removed -->

            </div>
        </div>
    </div>



    <!-- Mobile Bottom Navbar (DANA Style) -->
    <nav class="fixed bottom-0 left-0 z-50 w-full h-16 bg-white border-t border-gray-200 md:hidden shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
        <div class="grid h-full max-w-lg grid-cols-5 mx-auto font-medium">
            <a href="#" class="inline-flex flex-col items-center justify-center px-5 hover:bg-gray-50 group text-blue-600">
                <i class="fas fa-home w-6 h-6 mb-1 text-xl"></i>
                <span class="text-[10px]">Beranda</span>
            </a>
            <a href="#" class="inline-flex flex-col items-center justify-center px-5 hover:bg-gray-50 group text-gray-500">
                <i class="fas fa-chart-line w-6 h-6 mb-1 text-xl"></i>
                <span class="text-[10px]">Aktivitas</span>
            </a>
            <div class="relative flex items-center justify-center">
                <a href="#order-section" class="absolute -top-6 inline-flex items-center justify-center w-14 h-14 font-bold text-white bg-blue-600 rounded-full shadow-lg border-4 border-white hover:bg-blue-700 transition-transform active:scale-95">
                    <i class="fas fa-plus text-xl"></i>
                </a>
                <span class="absolute bottom-2 text-[10px] text-gray-500">Pesanan</span>
            </div>
            <a href="#status-section" class="inline-flex flex-col items-center justify-center px-5 hover:bg-gray-50 group text-gray-500">
                <i class="fas fa-history w-6 h-6 mb-1 text-xl"></i>
                <span class="text-[10px]">Riwayat</span>
            </a>
            <a href="#" class="inline-flex flex-col items-center justify-center px-5 hover:bg-gray-50 group text-gray-500">
                <i class="fas fa-user w-6 h-6 mb-1 text-xl"></i>
                <span class="text-[10px]">Akun</span>
            </a>
        </div>
    </nav>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="fixed inset-0 z-[70] hidden items-center justify-center bg-black/50 backdrop-blur-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-11/12 max-w-md p-6 animate-fade-in">
            <h3 class="text-xl font-bold text-gray-900 mb-4">Konfirmasi Pesanan</h3>
            <div class="bg-gray-50 p-4 rounded-xl mb-4 text-sm space-y-2 border border-gray-100">
                <div class="flex justify-between"><span class="text-gray-500">Layanan:</span> <span id="conf-service" class="font-semibold text-right truncate w-40">...</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Target:</span> <span id="conf-target" class="font-semibold text-right truncate w-40">...</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Jumlah:</span> <span id="conf-quantity" class="font-semibold">0</span></div>
                <div class="border-t border-gray-200 my-2"></div>
                <div class="flex justify-between items-center"><span class="text-gray-800 font-bold">Total Bayar:</span> <span id="conf-total" class="text-blue-600 font-bold text-lg">Rp 0</span></div>
            </div>
            <div class="flex space-x-3">
                <button onclick="closeConfirmModal()" class="flex-1 py-2.5 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium transition">Batal</button>
                <button onclick="submitOrder()" class="flex-1 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-medium transition shadow-lg shadow-blue-600/30">Ya, Pesan</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alert-modal" class="fixed inset-0 z-[80] hidden items-center justify-center bg-black/50">
        <div class="bg-white rounded-2xl shadow-2xl w-11/12 max-w-sm p-6 text-center animate-fade-in">
            <div id="alert-icon" class="w-16 h-16 rounded-full bg-green-100 text-green-500 flex items-center justify-center mx-auto mb-4 text-2xl">
                <i class="fas fa-check"></i>
            </div>
            <h3 id="alert-title" class="text-xl font-bold text-gray-900 mb-2">Berhasil!</h3>
            <p id="alert-msg" class="text-gray-600 text-sm mb-6">Pesanan Anda telah diterima.</p>
            <button onclick="closeAlertModal()" class="w-full py-2.5 bg-gray-900 text-white rounded-xl font-medium hover:bg-gray-800 transition">Tutup</button>
        </div>
    </div>

  <script>
/* ============================================================
   LOAD CONFIG DARI BACKEND (Database via api.php)
   ============================================================ */

let API_ENDPOINT = "";
let API_ID = "";
let API_KEY = "";

async function loadConfig() {
    try {
        const response = await fetch("https://boosteryuk.zya.me/api.php?action=layanan_data");
        const data = await response.json();

        if (data.status !== "success") {
            throw new Error("Config gagal dimuat");
        }

        API_ENDPOINT = data.API_ENDPOINT;
        API_ID = data.API_ID;
        API_KEY = data.API_KEY;

        console.log("Config Loaded:", data);

        // Setelah config berhasil â†’ load services
        fetchServices();
    } catch (err) {
        console.error("Gagal memuat config:", err);
        document.getElementById('api-status-msg').innerText =
            "Gagal memuat konfigurasi server!";
    }
}

/* ============================================================
   FALLBACK SERVICES
   ============================================================ */
let servicesData = [];
let currentSlide = 0;

const fallbackServices = [
    { id: 6, name: "Whatsapp OTP", category: "Whatsapp Services", price: 2000, min: 1, max: 100, description: "Layanan OTP Whatsapp cepat." },
    { id: 1, name: "Instagram Followers HQ", category: "Instagram Followers", price: 15000, min: 100, max: 10000, description: "High Quality followers." },
    { id: 2, name: "Instagram Followers Refill", price: 25000, category: "Instagram Followers", min: 100, max: 50000, description: "Garansi refill 30 hari." },
    { id: 3, name: "Instagram Likes HQ", category: "Instagram Likes", price: 5000, min: 50, max: 10000, description: "Fast likes HQ." },
    { id: 4, name: "Tiktok Followers Instant", category: "Tiktok Followers", price: 40000, min: 100, max: 20000, description: "Super fast followers." },
    { id: 5, name: "Tiktok Views", category: "Tiktok Views", price: 1000, min: 1000, max: 1000000, description: "Cheap views." }
];

/* ============================================================
   INIT PAGE
   ============================================================ */
document.addEventListener('DOMContentLoaded', () => {
    loadConfig();
    startSlider();

    setTimeout(() => {
        document.getElementById('info-popup').classList.remove('hidden');
    }, 500);
});

/* ============================================================
   UI & SLIDER FUNCTIONS
   ============================================================ */
function toggleMenu() {
    document.getElementById('mobile-menu').classList.toggle('open');
}

function closePopup() {
    const popup = document.getElementById('info-popup');
    popup.classList.add('opacity-0');
    setTimeout(() => popup.classList.add('hidden'), 300);
}

function startSlider() {
    setInterval(() => changeSlide(1), 5000);
}

function changeSlide(dir) {
    const slides = document.querySelectorAll('.slide');
    slides[currentSlide].classList.remove('opacity-100');
    slides[currentSlide].classList.add('opacity-0');

    currentSlide = (currentSlide + dir + slides.length) % slides.length;

    slides[currentSlide].classList.remove('opacity-0');
    slides[currentSlide].classList.add('opacity-100');
}

/* ============================================================
   FETCH SERVICES FROM API
   ============================================================ */
async function fetchServices() {
    const statusMsg = document.getElementById('api-status-msg');
    statusMsg.innerText = "Memuat layanan...";

    try {
        const formData = new FormData();
        formData.append('api_id', API_ID);
        formData.append('api_key', API_KEY);
        formData.append('action', 'services');

        const timeout = new Promise((_, reject) =>
            setTimeout(() => reject(new Error("Timeout")), 5000)
        );

        const fetchReq = fetch(API_ENDPOINT + '/services', {
            method: 'POST',
            body: formData
        });

        const response = await Promise.race([fetchReq, timeout]);
        const data = await response.json();

        if (!data.status) throw new Error("API Error");

        servicesData = data.services;
        statusMsg.innerText = "Data loaded from Live API";

    } catch (error) {
        console.warn("API gagal (CORS/Offline). Pakai fallback.", error);
        servicesData = fallbackServices;
        statusMsg.innerText = "Mode Demonstrasi (Offline Data)";
    }

    populateCategories();
}

/* ============================================================
   POPULATE CATEGORY & SERVICE LIST
   ============================================================ */
function populateCategories() {
    const categorySelect = document.getElementById('category');
    const categories = [...new Set(servicesData.map(s => s.category))]
        .sort((a, b) => {
            const aw = a.toLowerCase().includes('whatsapp');
            const bw = b.toLowerCase().includes('whatsapp');
            if (aw && !bw) return -1;
            if (!aw && bw) return 1;
            return a.localeCompare(b);
        });

    categorySelect.innerHTML = '<option value="">-- Pilih Kategori --</option>';

    categories.forEach(cat => {
        const op = document.createElement('option');
        op.value = cat;
        op.textContent = cat;
        categorySelect.appendChild(op);
    });

    categorySelect.addEventListener('change', populateServices);
}

function populateServices() {
    const serviceSelect = document.getElementById('service');
    const category = document.getElementById('category').value;

    serviceSelect.innerHTML = '<option value="">-- Pilih Layanan --</option>';
    serviceSelect.disabled = true;

    document.getElementById('description-box').classList.add('hidden');
    resetForm();

    if (!category) return;

    const filtered = servicesData.filter(s => s.category === category);

    filtered.forEach(s => {
        const rate = Number(s.price || s.rate || 0);

        let markup = 0;
        if (rate < 1000) markup = 11000;
        else if (rate < 3000) markup = 12000;
        else if (rate < 5000) markup = 13000;
        else markup = 14000;

        const finalPrice = rate + markup;

        const op = document.createElement('option');
        op.value = s.id;
        op.textContent = `${s.name} - Rp ${finalPrice.toLocaleString('id-ID')}`;
        op.dataset.min = s.min;
        op.dataset.max = s.max;
        op.dataset.price = finalPrice;
        op.dataset.desc = s.description;
        serviceSelect.appendChild(op);
    });

    serviceSelect.disabled = false;
    serviceSelect.removeEventListener('change', updateServiceDetails);
    serviceSelect.addEventListener('change', updateServiceDetails);
}

/* ============================================================
   SERVICE DETAIL + PRICE
   ============================================================ */
function updateServiceDetails() {
    const serviceSelect = document.getElementById('service');
    const op = serviceSelect.options[serviceSelect.selectedIndex];

    if (!op.value) {
        document.getElementById('description-box').classList.add('hidden');
        return;
    }

    document.getElementById('description-box').classList.remove('hidden');
    document.getElementById('service-description').innerHTML = op.dataset.desc;
    document.getElementById('min-order').textContent = Number(op.dataset.min).toLocaleString('id-ID');
    document.getElementById('max-order').textContent = Number(op.dataset.max).toLocaleString('id-ID');
    document.getElementById('price-per-k').textContent = Number(op.dataset.price).toLocaleString('id-ID');

    calculateTotal();
}

function resetForm() {
    document.getElementById('quantity').value = '';
    document.getElementById('total-price').textContent = '0';
}

function formatQuantity(input) {
    let value = input.value.replace(/\D/g, '');
    input.value = value ? Number(value).toLocaleString('id-ID') : "";
    calculateTotal();
}

function calculateTotal() {
    const raw = document.getElementById('quantity').value.replace(/\./g, '');
    const qty = parseInt(raw) || 0;
    const priceEl = document.getElementById('total-price');
    const priceContainer = document.getElementById('price-display-container');
    const serviceSelect = document.getElementById('service');

    if (serviceSelect.value && qty > 0) {
        const rate = Number(serviceSelect.options[serviceSelect.selectedIndex].dataset.price);
        const total = Math.ceil((qty / 1000) * rate);
        const formatted = total.toLocaleString('id-ID');

        priceEl.textContent = formatted;

        const len = formatted.length;
        priceContainer.className = 'font-bold transition-all whitespace-nowrap';

        if (len > 12) priceContainer.classList.add('text-sm');
        else if (len > 9) priceContainer.classList.add('text-base');
        else if (len > 7) priceContainer.classList.add('text-lg');
        else priceContainer.classList.add('text-xl');

    } else {
        priceEl.textContent = '0';
        priceContainer.className = 'text-xl font-bold transition-all whitespace-nowrap';
    }
}

/* ============================================================
   ORDER CONFIRMATION
   ============================================================ */
function openConfirmModal() {
    const serviceSelect = document.getElementById('service');
    const target = document.getElementById('target').value;
    const rawQty = document.getElementById('quantity').value.replace(/\./g, '');

    if (!serviceSelect.value || !target || !rawQty) {
        showAlert('Gagal', 'Mohon lengkapi semua data pemesanan.', 'error');
        return;
    }

    const serviceName = serviceSelect.options[serviceSelect.selectedIndex].text.split(' - ')[0];

    document.getElementById('conf-service').textContent = serviceName;
    document.getElementById('conf-target').textContent = target;
    document.getElementById('conf-quantity').textContent = document.getElementById('quantity').value;
    document.getElementById('conf-total').textContent = "Rp " + document.getElementById('total-price').textContent;

    document.getElementById('confirm-modal').classList.remove('hidden');
    document.getElementById('confirm-modal').classList.add('flex');
}

function closeConfirmModal() {
    document.getElementById('confirm-modal').classList.add('hidden');
    document.getElementById('confirm-modal').classList.remove('flex');
}

function submitOrder() {
    closeConfirmModal();

    const serviceSelect = document.getElementById('service');
    const serviceName = serviceSelect.options[serviceSelect.selectedIndex].text;
    const target = document.getElementById('target').value;
    const qty = document.getElementById('quantity').value;
    const total = document.getElementById('total-price').textContent;

    const msg = `Halo Admin, saya ingin memesan layanan ini:

ðŸ“Œ *DETAIL PESANAN*
ðŸ“¦ *Layanan:* ${serviceName}
ðŸŽ¯ *Target:* ${target}
ðŸ”¢ *Jumlah:* ${qty}
ðŸ’° *Total Harga:* Rp ${total}

Mohon segera diproses.`;

    const wa = "6288976577719";
    window.open(`https://wa.me/${wa}?text=${encodeURIComponent(msg)}`, '_blank');

    document.getElementById('target').value = '';
    document.getElementById('quantity').value = '';
    document.getElementById('total-price').textContent = '0';
}

/* ============================================================
   ORDER STATUS
   ============================================================ */
async function checkStatus() {
    const id = document.getElementById('order-id-check').value;

    if (!id) {
        showAlert('Error', 'Masukkan ID Pesanan', 'error');
        return;
    }

    const btn = document.querySelector('#status-section button');
    const original = btn.innerText;
    btn.innerText = 'Mengecek...';
    btn.disabled = true;

    const resultDiv = document.getElementById('status-result');
    resultDiv.classList.add('hidden');

    let data;

    try {
        const formData = new FormData();
        formData.append('api_id', API_ID);
        formData.append('api_key', API_KEY);
        formData.append('id', id);

        data = await (await fetch(API_ENDPOINT + '/status', {
            method: 'POST',
            body: formData
        })).json();

    } catch (err) {
        await new Promise(r => setTimeout(r, 1000));
        if (id == '1107') {
            data = {
                status: true,
                msg: "Pesanan ditemukan.",
                order_status: "processing",
                start_count: 10,
                remains: 90
            };
        } else {
            data = {
                status: false,
                msg: "Pesanan tidak ditemukan."
            };
        }
    }

    if (data.status) {
        const map = {
            pending: 'Pending',
            processing: 'Sedang Proses',
            success: 'Sukses',
            completed: 'Selesai',
            error: 'Error',
            partial: 'Partial',
            canceled: 'Dibatalkan'
        };

        document.getElementById('res-status').innerText = map[data.order_status] || data.order_status;
        document.getElementById('res-start').innerText = data.start_count;
        document.getElementById('res-remains').innerText = data.remains;

        resultDiv.classList.remove('hidden');
    } else {
        showAlert('Gagal', data.msg, 'error');
    }

    btn.innerText = original;
    btn.disabled = false;
}

/* ============================================================
   ALERT BOX
   ============================================================ */
function showAlert(title, message, type) {
    const modal = document.getElementById('alert-modal');
    const icon = document.getElementById('alert-icon');
    const titleEl = document.getElementById('alert-title');
    const msgEl = document.getElementById('alert-msg');

    titleEl.textContent = title;
    msgEl.textContent = message;

    if (type === 'success') {
        icon.className = 'w-16 h-16 rounded-full bg-green-100 text-green-500 flex items-center justify-center mx-auto mb-4 text-2xl';
        icon.innerHTML = '<i class="fas fa-check"></i>';
    } else {
        icon.className = 'w-16 h-16 rounded-full bg-red-100 text-red-500 flex items-center justify-center mx-auto mb-4 text-2xl';
        icon.innerHTML = '<i class="fas fa-times"></i>';
    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');
}

function closeAlertModal() {
    const modal = document.getElementById('alert-modal');
    modal.classList.add('hidden');
    modal.classList.remove('flex');
}
</script>
</body>
</html>
